<!-- app/templates/import/ddt.html -->
{% extends "_base.html" %}
{% block title %}{{ page_title }}{% endblock %}

{% block content %}
<!-- Loading overlay component -->
{% include "components/loading-overlay.html" %}

<div class="bg-white p-6 rounded-xl shadow space-y-6" data-module="ddt-import">
  
  <!-- Header -->
  <div class="flex items-center justify-between">
    <div>
      <h1 class="text-xl font-semibold">{{ page_title }}</h1>
      <p class="text-sm text-gray-600 mt-1">
        Carica un PDF DDT fornitore per estrarre automaticamente i dati
      </p>
    </div>
    <div class="text-xs text-gray-500 bg-gray-100 px-3 py-2 rounded-full">
      Max {{ import_max_file_size }} â€¢ Formati: {{ supported_formats|join(', ') }}
    </div>
  </div>

  <!-- Step 1: Upload & Parse -->
  {% include "components/ddt-upload-form.html" %}

  <!-- Step 2: Parsing Result Note -->
  {% include "components/ddt-parsing-note.html" %}

  <!-- Step 3: Editable Meta -->
  {% include "components/ddt-meta-editor.html" %}

  <!-- Step 4: Editable Rows -->
  {% include "components/ddt-rows-editor.html" %}

  <!-- Step 5: Dev Utils (if debug mode) -->
  {% if config.DEBUG %}
  <div class="border-t pt-4">
    <h4 class="text-sm font-medium text-gray-700 mb-2">ğŸ› ï¸ UtilitÃ  Sviluppo</h4>
    <div class="flex gap-2">
      <button id="btn-clear-in" class="px-3 py-1 border border-red-300 text-red-700 rounded text-xs hover:bg-red-50">
        ğŸ—‘ï¸ Clear DDT IN
      </button>
      <button id="btn-clear-out" class="px-3 py-1 border border-red-300 text-red-700 rounded text-xs hover:bg-red-50">
        ğŸ—‘ï¸ Clear DDT OUT
      </button>
      <button id="btn-clear-art" class="px-3 py-1 border border-red-300 text-red-700 rounded text-xs hover:bg-red-50">
        ğŸ—‘ï¸ Clear Articoli
      </button>
    </div>
  </div>
  {% endif %}

</div>
{% endblock %}

{% block scripts %}
<!-- Shared utilities -->
<script src="{{ url_for('static', filename='js/shared/api-client.js') }}"></script>
<script src="{{ url_for('static', filename='js/shared/error-handler.js') }}"></script>
<script src="{{ url_for('static', filename='js/shared/loading-overlay.js') }}"></script>

<!-- Main DDT import logic -->
<script src="{{ url_for('static', filename='js/pages/ddt-import.js') }}"></script>
{% endblock %}